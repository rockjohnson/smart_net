设计思想：
1，engine本身不做复杂的处理了，endpoint中做状态机控制